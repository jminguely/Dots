function initializeGrid(e){textLatestNews=e.textLatestNews,WebFont.load({custom:{families:["CustomMuseoSansBold"]},active:function(){init()}})}function init(){setDimension(),myView=document.getElementById("grid"),renderer=PIXI.autoDetectRenderer(widthWindow,heightWindow,{view:myView,transparent:!0,antialias:!1,resolution:aspectRatio}),stage=new PIXI.Container,renderer.render(stage),graphics=new PIXI.Graphics,graphics2=new PIXI.Graphics,lines=new PIXI.Graphics,animationGraphics=new PIXI.Graphics,stage.addChild(graphics),stage.addChild(graphics2),stage.addChild(lines),stage.addChild(animationGraphics),document.onmousemove=mouseEventHandler,doneResizing(),render()}function resizeStart(){clearTimeout(resizeId),flushStage(),graphics.clear(),graphics2.clear(),destroyLatestNews(),animationGraphics.clear(),$("div.overlay").removeClass("visible").find(".content").html(""),resizeId=setTimeout(doneResizing,500)}function flushStage(){"undefined"!=typeof gridElements&&gridElements.forEach(function(e){e.graphics&&e.graphics.clear()})}function setDimension(){widthWindow=$("#grid").width(),heightWindow=$("#grid").height(),aspectRatio=window.devicePixelRatio}function doneResizing(){startScriptTime=(new Date).getTime(),setDimension(),renderer.resize(widthWindow,heightWindow),cols=Math.ceil(widthWindow/(marginDot+2*radiusDot)),rows=Math.ceil(heightWindow/(marginDot+2*radiusDot)),drawGrid()}function drawGrid(){for(var e=0;cols>e;e++)for(var t=0;rows>t;t++){var i=e*(marginDot+2*radiusDot)+marginDot+radiusDot,a=t*(marginDot+2*radiusDot)+marginDot+radiusDot;graphics.beginFill("0x"+mainColor),graphics.drawCircle(i,a,radiusDot),graphics.endFill()}"undefined"!=typeof gridElements&&gridElements.forEach(function(e,t){var i=Math.round(cols/100*e.dotX),a=Math.round(rows/100*e.dotY);gridElements[t].graphics=new PIXI.Graphics,stage.addChild(gridElements[t].graphics),gridElements[t].graphics.beginFill("0x"+secondColor);for(var o=1;o>=-1;o--)for(var r=1;r>=-1;r--)if(Math.abs(o)!=Math.abs(r)||0===o&&0===r){var n=(i+o)*(marginDot+2*radiusDot)+marginDot+radiusDot,s=(a+r)*(marginDot+2*radiusDot)+marginDot+radiusDot;gridElements[t].graphics.drawCircle(n,s,radiusDot)}gridElements[t].graphics.endFill(),gridElements[t].graphics.interactive=!0,gridElements[t].graphics.buttonMode=!0,gridElements[t].graphics.defaultCursor="pointer";var d=2*(2*radiusDot+marginDot);gridElements[t].graphics.hitArea=new PIXI.Rectangle(i*(marginDot+2*radiusDot)+marginDot+radiusDot-d,a*(marginDot+2*radiusDot)+marginDot+radiusDot-d,2*d,2*d),gridElements[t].graphics.click=gridElements[t].graphics.tap=function(o){destroyLatestNews(),currentElementId===t?("html"==e.type&&closeOverlay(),"keywords"==e.type&&hideKeywords(),animationGraphics.clear(),currentElementId=void 0):(hideKeywords(),currentElementId=t,xBox=(i+e.overlayX)*(marginDot+2*radiusDot)+marginDot+radiusDot-e.anchorX,yBox=(a+e.overlayY)*(marginDot+2*radiusDot)+marginDot+radiusDot-e.anchorY,playAnimation(i,a,e.animation),"html"===e.type?changeOverlayContent(e.src,xBox,yBox,e.w,e.h):"keywords"===e.type&&(closeOverlay(),displayKeywords(e.content,xBox,yBox,e.urlLink)),e.titleLatestNews===!0&&drawLatestNews(i,a))}})}function drawLatestNews(e,t){news=new PIXI.Text("NEWS".split("").join(String.fromCharCode(8202)),{font:"20px CustomMuseoSansBold",fill:"#"+secondColor,stroke:"#FFFFFF",strokeThickness:3}),news.pivot=new PIXI.Point(-news.height/2,news.height/2),news.resolution=2,news.x=(e-6)*(marginDot+2*radiusDot),news.y=(t-6)*(marginDot+2*radiusDot),console.log(textLatestNews),latest=new PIXI.Text(textLatestNews.toString(),{font:"20px CustomMuseoSansBold",fill:"#"+secondColor,stroke:"#FFFFFF",strokeThickness:3}),latest.pivot=new PIXI.Point(0,latest.height/2),latest.rotation=-1.5708,latest.resolution=2,latest.x=(e-6)*(marginDot+2*radiusDot),latest.y=(t+3)*(marginDot+2*radiusDot)+2,stage.addChild(latest),stage.addChild(news)}function destroyLatestNews(){latest&&latest.destroy(),news&&news.destroy()}function playAnimation(e,t,i){animationGraphics.clear();var a=animations[i];for(var o in a){var r=a[o],n=[];for(var s in r)n.push([e+r[s][0],t+r[s][1]]);animationQueue.push(n)}}function hideKeywords(){for(var e in keywords)keywords[e].textObject.destroy();keywords=[]}function displayKeywords(e,t,i,a){var o=0,r=0,n=0,s=0;for(var d in e){var l=e[d],c=new PIXI.Text(l.toUpperCase().split("").join(String.fromCharCode(8202)),{font:"20px CustomMuseoSansBold",fill:"#"+secondColor,stroke:"#FFFFFF",strokeThickness:3});c.pivot=new PIXI.Point(c.width/2,c.height/2),c.resolution=2,""!=a&&void 0!=a&&(c.interactive=!0,c.buttonMode=!0,c.defaultCursor="pointer",c.click=c.tap=function(e){document.location.href=a});var h,m;s>0?(h=t-o/2,m=i+3*r):o>0?(h=t+o/3,m=i+1.5*r,n=c.width,s=c.height):(h=t,m=i),o=c.width,r=c.height,stage.addChild(c),c.x=t,c.y=i,keywords.push({textObject:c,x:h,y:m,baseX:t,baseY:i,objX:h+Math.round(Math.random()*defaultDistance-defaultDistance/2),objY:m+Math.round(Math.random()*defaultDistance-defaultDistance/2),lifespanAnimation:90,currentTimeAnimation:0})}}function closeOverlay(){$("div.overlay").removeClass("visible").css({top:0,width:0,height:0,left:0}),$("div.overlay .content").html("")}function changeOverlayContent(e,t,i,a,o){0>=t&&(t=0),0>=i&&(i=0),t+a>widthWindow&&(t=widthWindow-a),i+o>heightWindow&&(i=heightWindow-o),$("div.overlay").hasClass("visible")?($("div.overlay").removeClass("visible"),setTimeout(function(){$("div.overlay .content").html(e),$("div.overlay").addClass("visible").css({left:t,top:i,width:a,height:o})},300)):($("div.overlay").addClass("visible").css({left:t,top:i,width:a,height:o}),$("div.overlay .content").html(e))}function rgb(e){return e.match(/\w\w/g).map(function(e){return parseInt(e,16)})}function blendColor(e,t,i){for(var e=rgb(e),t=rgb(t),a=[],o=0;3>o;o++)a[o]=e[o]+i*(t[o]-e[o])|0;return a.map(function(e){return e.toString(16)}).map(function(e){return"00".slice(e.length)+e}).join("")}function mouseEventHandler(e){var t=$("#grid").offset(),i=e.pageX-t.left,a=e.pageY-t.top;interactionHandler(i,a)}function interactionHandler(e,t){for(var i=e/widthWindow,a=t/heightWindow,o=Math.round(cols*i),r=Math.round(rows*a),n=4,s=n,d=-s;s>=d;d++)for(var l=-s;s>=l;l++)if(o+d>=0&&cols>o+d&&r+l>=0&&rows>r+l){var c=o+d+"-"+(r+l),h=Math.max(Math.ceil(Math.sqrt(Math.pow(Math.abs(d),2)+Math.pow(Math.abs(l),2))),1);(!affectedDots.hasOwnProperty(c)||h<affectedDots[c].distance)&&(affectedDots[c]={distance:h,effet:h/Math.sqrt(Math.pow(s,2)+Math.pow(s,2)),x:o+d,y:r+l,lifespan:defaultLifespan})}}function render(){var e=(new Date).getTime(),t=(e-lastTickTime)/1e3,i=1/t;if(lowPerf=i>20?!1:!0,lowPerf||graphics2.clear(),lines.clear(),!lowPerf)for(var a in affectedDots){affectedDots[a].lifespan=affectedDots[a].lifespan-1;var o=affectedDots[a],r=o.x*(marginDot+2*radiusDot)+marginDot+radiusDot,n=o.y*(marginDot+2*radiusDot)+marginDot+radiusDot,s=(1-o.effet)/defaultLifespan*affectedDots[a].lifespan;graphics2.beginFill("0x"+blendColor(mainColor,primColor,s)),graphics2.drawCircle(r,n,Math.max(radiusDot/o.effet/6,radiusDot)),graphics2.endFill(),affectedDots[a].lifespan<=0&&delete affectedDots[a]}for(var d in keywords){if(keyword=keywords[d],keyword.currentTimeAnimation>=keyword.lifespanAnimation){var l=Math.round(Math.random()*defaultLifespanAnimation)+defaultLifespanAnimation/2;keyword.lifespanAnimation=l,keyword.currentTimeAnimation=0,keywords[d].baseX=keywords[d].textObject.x,keywords[d].baseY=keywords[d].textObject.y,keywords[d].objX=keywords[d].x+Math.random()*defaultDistance-defaultDistance/2,keywords[d].objY=keywords[d].y+Math.random()*defaultDistance-defaultDistance/2}keyword.currentTimeAnimation++;var c=easeInOut(keyword.currentTimeAnimation,keywords[d].baseX,keywords[d].objX-keywords[d].baseX,keyword.lifespanAnimation),h=easeInOut(keyword.currentTimeAnimation,keywords[d].baseY,keywords[d].objY-keywords[d].baseY,keyword.lifespanAnimation);keyword.textObject.x=c,keyword.textObject.y=h;var m=parseInt(d)+1;parseInt(d)===keywords.length-1&&(m=0);var w=keywords[d].textObject.x,u=keywords[d].textObject.y,f=keywords[m].textObject.x,g=keywords[m].textObject.y;0===parseInt(d)&&(w+=.15*keywords[d].textObject.width,f-=.25*keywords[m].textObject.width),1===parseInt(d)&&(w-=.25*keywords[d].textObject.width,f+=.1*keywords[m].textObject.width),2===parseInt(d)&&(w+=.1*keywords[d].textObject.width,f-=.4*keywords[m].textObject.width),lines.lineStyle(2,"0x"+primColor,1),lines.moveTo(w,u),lines.lineTo(f,g)}if(lastTickTime=e,!lowPerf&&(lastTickTime-lastAnimationTime>animationSpeed||void 0===lastAnimationTime)){if(void 0!==animationQueue[0]){var p=animationQueue.shift();for(dotId in p){var o=p[dotId],r=o[0]*(marginDot+2*radiusDot)+marginDot+radiusDot,n=o[1]*(marginDot+2*radiusDot)+marginDot+radiusDot;animationGraphics.beginFill("0x"+primColor),animationGraphics.drawCircle(r,n,radiusDot),animationGraphics.endFill()}}lastAnimationTime=lastTickTime}var p=50,y=250,D=(e-startScriptTime)/animationSpeed+50,v=Math.floor(D/p);if(4>v){var k=Math.abs(1-D%(v*p)/25);gridElements.forEach(function(e){e.graphics&&(e.graphics.alpha=k)})}renderer.render(stage),requestAnimationFrame(render)}function easeInOut(e,t,i,a){return(e/=a/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t}var dots=[],resizeId,mainColor="e6e6e5",primColor="98c21f",secondColor="a773b4",widthWindow,heightWindow,aspectRatio,radiusDot=3,marginDot=5,cols=0,rows=0,currentElementId=void 0,renderer,stage,graphics,lastTickTime,lastAnimationTime,defaultLifespanAnimation=200,defaultDistance=20,lowPerf=!1,animationQueue=[],animationSpeed=40,keywords=[],affectedDots=[],defaultLifespan=20,lastCoord=[],animations=[[[[-3,-3]],[[-2,-2]],[[-1,-1]],[[0,0]],[[1,1]],[[2,2]],[[3,3]]],[[[4,-4]],[[3,-3]],[[2,-2]],[[1,-1]],[[0,0]],[[-1,1]],[[-2,2]]],[[[0,-2],[0,2],[2,0],[-2,0]],[[0,-3],[0,3],[3,0],[-3,0]],[[0,-4],[0,4],[4,0],[-4,0]],[[0,-5],[0,5],[5,0],[-5,0]]],[[[0,-2],[0,2],[2,0],[-2,0]],[[0,-3],[-3,0]],[[0,-4],[-4,0]],[[0,-5],[-4,0]],[[0,-6],[-5,0]]],[[[0,-2],[0,2],[2,0],[-2,0]],[[0,-3],[3,0]],[[0,-4],[4,0]]],[[[0,-2],[0,2],[2,0],[-2,0]],[[0,3],[3,0]],[[0,4],[4,0]]],[[[0,-2],[0,2],[2,0],[-2,0]],[[0,3],[-3,0]],[[0,4],[-4,0]]],[[[-4,-4]],[[-3,-3]],[[-2,-2]],[[-1,-1]],[[0,0]],[[1,0]],[[2,0]],[[3,0]]],[[[4,-4]],[[3,-3]],[[2,-2]],[[1,-1]],[[0,0]],[[-1,0]],[[-2,0]],[[-3,0]]],[[[4,-4]],[[3,-3]],[[2,-2]],[[1,-1]],[[0,0]],[[-1,1]],[[-2,2]],[[-2,1],[-1,2]],[[-2,0],[0,2]],[[-2,-1],[1,2]]],[[[-4,-4]],[[-3,-3]],[[-2,-2]],[[-1,-1]],[[0,0]],[[1,1]],[[2,2]],[[2,1],[1,2]],[[2,0],[0,2]],[[2,-1],[-1,2]]],[[[-5,2],[2,-5]],[[-5,1],[-4,2],[1,-5],[2,-4]],[[-5,0],[-3,2],[0,-5],[2,-3]],[[-5,-1],[-2,2],[-1,-5],[2,-2]],[[-5,-2],[-1,2],[-2,-5],[2,-1]],[[-5,-3],[0,2],[-3,-5],[2,0]],[[-5,-4],[1,2],[-4,-5],[2,1]],[[-5,-5],[2,2],[-5,-5],[2,2]],[[-4,1],[1,-4]],[[-4,0],[-3,1],[0,-4],[1,-3]],[[-4,-1],[-2,1],[-1,-4],[1,-2]],[[-4,-2],[-1,1],[-2,-4],[1,-1]],[[-4,-3],[-3,-4]],[[-4,-4],[1,1],[-4,-4],[1,1]],[[-3,0],[0,-3]],[[-3,-1],[-1,-3],[0,-2]],[[-3,-2],[-2,-3]],[[-3,-3],[-3,-3]],[[-2,-1],[-1,-2]],[[-2,-2],[-2,-2],[-1,-1]],[[-2,0]]],[[[-3,0]],[[-2,0]],[[-1,0]],[[-0,0]],[[1,1]],[[2,2]],[[3,3]],[[4,4]]]],textLatestNews="DERNIERES";window.onresize=resizeStart;var latest,news,startScriptTime;