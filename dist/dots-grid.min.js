function initializeGrid(e){textLatestNews=e.textLatestNews,WebFont.load({custom:{families:["CustomMuseoSansBold"]},active:function(){init()}})}function launchRandomPoint(){if(gridElements.length>1){var e;for(e=Math.floor(Math.random()*gridElements.length);lastRandomNumber===e;)e=Math.floor(Math.random()*gridElements.length);lastRandomNumber=e,gridElements[e]&&gridElements[e].graphics&&gridElements[e].graphics.click(),setTimeout(function(){userInteracted||launchRandomPoint()},delayShowRandom)}}function init(){setDimension(),myView=document.getElementById("grid"),myView.addEventListener("click",interactionUser,!1),myView.addEventListener("touchend",interactionUser,!1),renderer=PIXI.autoDetectRenderer(widthWindow,heightWindow,{view:myView,transparent:!0,antialias:!1,resolution:aspectRatio}),stage=new PIXI.Container,renderer.render(stage),renderer.plugins.interaction.autoPreventDefault=!1,graphics=new PIXI.Graphics,graphics2=new PIXI.Graphics,lines=new PIXI.Graphics,animationGraphics=new PIXI.Graphics,stage.addChild(graphics),stage.addChild(graphics2),stage.addChild(lines),stage.addChild(animationGraphics),document.onmousemove=mouseEventHandler,doneResizing(),render(),launchRandomPoint()}function interactionUser(){userInteracted=!0}function resizeStart(){clearTimeout(resizeId),flushStage(),graphics.clear(),graphics2.clear(),destroyLatestNews(),animationGraphics.clear(),$("div.overlay").removeClass("visible").find(".content").html(""),resizeId=setTimeout(doneResizing,500)}function flushStage(){"undefined"!=typeof gridElements&&gridElements.forEach(function(e){e.graphics&&e.graphics.clear()})}function setDimension(){widthWindow=$("#grid").width(),heightWindow=$("#grid").height(),aspectRatio=window.devicePixelRatio}function doneResizing(){startScriptTime=(new Date).getTime(),setDimension(),renderer.resize(widthWindow,heightWindow),cols=Math.ceil(widthWindow/(marginDot+2*radiusDot)),rows=Math.ceil(heightWindow/(marginDot+2*radiusDot)),drawGrid()}function drawGrid(){for(var e=0;cols>e;e++)for(var t=0;rows>t;t++){var i=e*(marginDot+2*radiusDot)+marginDot+radiusDot,a=t*(marginDot+2*radiusDot)+marginDot+radiusDot;graphics.beginFill("0x"+mainColor),graphics.drawCircle(i,a,radiusDot),graphics.endFill()}"undefined"!=typeof gridElements&&gridElements.forEach(function(e,t){var i=Math.round(cols/100*e.dotX),a=Math.round(rows/100*e.dotY);gridElements[t].graphics=new PIXI.Graphics,stage.addChild(gridElements[t].graphics),gridElements[t].graphics.beginFill("0x"+secondColor);for(var r=1;r>=-1;r--)for(var o=1;o>=-1;o--)if(Math.abs(r)!=Math.abs(o)||0===r&&0===o){var n=(i+r)*(marginDot+2*radiusDot)+marginDot+radiusDot,s=(a+o)*(marginDot+2*radiusDot)+marginDot+radiusDot;gridElements[t].graphics.drawCircle(n,s,radiusDot)}gridElements[t].graphics.endFill(),gridElements[t].graphics.interactive=!0,gridElements[t].graphics.buttonMode=!0,gridElements[t].graphics.defaultCursor="pointer";var d=2*(2*radiusDot+marginDot);gridElements[t].graphics.hitArea=new PIXI.Rectangle(i*(marginDot+2*radiusDot)+marginDot+radiusDot-d,a*(marginDot+2*radiusDot)+marginDot+radiusDot-d,2*d,2*d),gridElements[t].graphics.click=gridElements[t].graphics.tap=function(r){destroyLatestNews(),currentElementId===t?("html"==e.type&&closeOverlay(),"keywords"==e.type&&hideKeywords(),animationGraphics.clear(),currentElementId=void 0):(hideKeywords(),currentElementId=t,xBox=(i+e.overlayX)*(marginDot+2*radiusDot)+marginDot+radiusDot-e.anchorX,yBox=(a+e.overlayY)*(marginDot+2*radiusDot)+marginDot+radiusDot-e.anchorY,playAnimation(i,a,e.animation),"html"===e.type?changeOverlayContent(e.src,xBox,yBox,e.w,e.h):"keywords"===e.type&&(closeOverlay(),displayKeywords(e.content,xBox,yBox,e.urlLink)),e.titleLatestNews===!0&&drawLatestNews(i,a))}})}function drawLatestNews(e,t){news=new PIXI.Text("NEWS".split("").join(String.fromCharCode(8202)),{font:"20px CustomMuseoSansBold",fill:"#"+secondColor,stroke:"#FFFFFF",strokeThickness:3}),news.pivot=new PIXI.Point(-news.height/2,news.height/2),news.resolution=2,news.x=(e-6)*(marginDot+2*radiusDot),news.y=(t-6)*(marginDot+2*radiusDot),latest=new PIXI.Text(textLatestNews.toString(),{font:"20px CustomMuseoSansBold",fill:"#"+secondColor,stroke:"#FFFFFF",strokeThickness:3}),latest.pivot=new PIXI.Point(0,latest.height/2),latest.rotation=-1.5708,latest.resolution=2,latest.x=(e-6)*(marginDot+2*radiusDot),latest.y=(t+3)*(marginDot+2*radiusDot)+2,stage.addChild(latest),stage.addChild(news)}function destroyLatestNews(){latest&&latest.destroy(),news&&news.destroy()}function playAnimation(e,t,i){animationGraphics.clear();var a=animations[i];for(var r in a){var o=a[r],n=[];for(var s in o)n.push([e+o[s][0],t+o[s][1]]);animationQueue.push(n)}}function hideKeywords(){for(var e in keywords)keywords[e].textObject.interactive=!1,keywords[e].textObject.buttonMode=!1,keywords[e].textObject.textObjectclick=keywords[e].textObject.tap=!1,keywords[e].textObject.destroy();keywords=[]}function displayKeywords(e,t,i,a){var r=0,o=0,n=0,s=0;for(var d in e){var l=e[d],c=new PIXI.Text(l.toUpperCase().split("").join(String.fromCharCode(8202)),{font:"20px CustomMuseoSansBold",fill:"#"+secondColor,stroke:"#FFFFFF",strokeThickness:3});c.pivot=new PIXI.Point(c.width/2,c.height/2),c.resolution=2,""!=a&&void 0!=a&&(c.interactive=!0,c.buttonMode=!0,c.defaultCursor="pointer",c.click=c.tap=function(e){document.location.href=a});var m,h;s>0?(m=t-r/2,h=i+3*o):r>0?(m=t+r/3,h=i+1.5*o,n=c.width,s=c.height):(m=t,h=i),r=c.width,o=c.height,stage.addChild(c),c.x=t,c.y=i,keywords.push({textObject:c,x:m,y:h,baseX:t,baseY:i,objX:m+Math.round(Math.random()*defaultDistance-defaultDistance/2),objY:h+Math.round(Math.random()*defaultDistance-defaultDistance/2),lifespanAnimation:90,currentTimeAnimation:0})}}function closeOverlay(){$("div.overlay").removeClass("visible").css({top:0,width:0,height:0,left:0}),$("div.overlay .content").html("")}function changeOverlayContent(e,t,i,a,r){0>=t&&(t=0),0>=i&&(i=0),t+a>widthWindow&&(t=widthWindow-a),i+r>heightWindow&&(i=heightWindow-r),$("div.overlay").hasClass("visible")?($("div.overlay").removeClass("visible"),setTimeout(function(){$("div.overlay .content").html(e),$("div.overlay").addClass("visible").css({left:t,top:i,width:a,height:r})},300)):($("div.overlay").addClass("visible").css({left:t,top:i,width:a,height:r}),$("div.overlay .content").html(e))}function rgb(e){return e.match(/\w\w/g).map(function(e){return parseInt(e,16)})}function blendColor(e,t,i){for(var e=rgb(e),t=rgb(t),a=[],r=0;3>r;r++)a[r]=e[r]+i*(t[r]-e[r])|0;return a.map(function(e){return e.toString(16)}).map(function(e){return"00".slice(e.length)+e}).join("")}function mouseEventHandler(e){var t=$("#grid").offset(),i=e.pageX-t.left,a=e.pageY-t.top;interactionHandler(i,a)}function interactionHandler(e,t){for(var i=e/widthWindow,a=t/heightWindow,r=Math.round(cols*i),o=Math.round(rows*a),n=4,s=n,d=-s;s>=d;d++)for(var l=-s;s>=l;l++)if(r+d>=0&&cols>r+d&&o+l>=0&&rows>o+l){var c=r+d+"-"+(o+l),m=Math.max(Math.ceil(Math.sqrt(Math.pow(Math.abs(d),2)+Math.pow(Math.abs(l),2))),1);(!affectedDots.hasOwnProperty(c)||m<affectedDots[c].distance)&&(affectedDots[c]={distance:m,effet:m/Math.sqrt(Math.pow(s,2)+Math.pow(s,2)),x:r+d,y:o+l,lifespan:defaultLifespan})}}function render(){var e=(new Date).getTime(),t=(e-lastTickTime)/1e3,i=1/t;if(lowPerf=i>20?!1:!0,lowPerf||graphics2.clear(),lines.clear(),!lowPerf)for(var a in affectedDots){affectedDots[a].lifespan=affectedDots[a].lifespan-1;var r=affectedDots[a],o=r.x*(marginDot+2*radiusDot)+marginDot+radiusDot,n=r.y*(marginDot+2*radiusDot)+marginDot+radiusDot,s=(1-r.effet)/defaultLifespan*affectedDots[a].lifespan;graphics2.beginFill("0x"+blendColor(mainColor,primColor,s)),graphics2.drawCircle(o,n,Math.max(radiusDot/r.effet/6,radiusDot)),graphics2.endFill(),affectedDots[a].lifespan<=0&&delete affectedDots[a]}for(var d in keywords){if(keyword=keywords[d],keyword.currentTimeAnimation>=keyword.lifespanAnimation){var l=Math.round(Math.random()*defaultLifespanAnimation)+defaultLifespanAnimation/2;keyword.lifespanAnimation=l,keyword.currentTimeAnimation=0,keywords[d].baseX=keywords[d].textObject.x,keywords[d].baseY=keywords[d].textObject.y,keywords[d].objX=keywords[d].x+Math.random()*defaultDistance-defaultDistance/2,keywords[d].objY=keywords[d].y+Math.random()*defaultDistance-defaultDistance/2}keyword.currentTimeAnimation++;var c=easeInOut(keyword.currentTimeAnimation,keywords[d].baseX,keywords[d].objX-keywords[d].baseX,keyword.lifespanAnimation),m=easeInOut(keyword.currentTimeAnimation,keywords[d].baseY,keywords[d].objY-keywords[d].baseY,keyword.lifespanAnimation);keyword.textObject.x=c,keyword.textObject.y=m;var h=parseInt(d)+1;parseInt(d)===keywords.length-1&&(h=0);var u=keywords[d].textObject.x,w=keywords[d].textObject.y,f=keywords[h].textObject.x,g=keywords[h].textObject.y;0===parseInt(d)&&(u+=.15*keywords[d].textObject.width,f-=.25*keywords[h].textObject.width),1===parseInt(d)&&(u-=.25*keywords[d].textObject.width,f+=.1*keywords[h].textObject.width),2===parseInt(d)&&(u+=.1*keywords[d].textObject.width,f-=.4*keywords[h].textObject.width),lines.lineStyle(2,"0x"+primColor,1),lines.moveTo(u,w),lines.lineTo(f,g)}if(lastTickTime=e,!lowPerf&&(lastTickTime-lastAnimationTime>animationSpeed||void 0===lastAnimationTime)){if(void 0!==animationQueue[0]){var p=animationQueue.shift();for(dotId in p){var r=p[dotId],o=r[0]*(marginDot+2*radiusDot)+marginDot+radiusDot,n=r[1]*(marginDot+2*radiusDot)+marginDot+radiusDot;animationGraphics.beginFill("0x"+primColor),animationGraphics.drawCircle(o,n,radiusDot),animationGraphics.endFill()}}lastAnimationTime=lastTickTime}renderer.render(stage),requestAnimationFrame(render)}function easeInOut(e,t,i,a){return(e/=a/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t}var dots=[],resizeId,mainColor="e6e6e5",primColor="98c21f",secondColor="a773b4",widthWindow,heightWindow,aspectRatio,radiusDot=3,marginDot=5,cols=0,rows=0,currentElementId=void 0,renderer,stage,graphics,lastTickTime,lastAnimationTime,defaultLifespanAnimation=200,defaultDistance=20,lowPerf=!1,animationQueue=[],animationSpeed=40,keywords=[],affectedDots=[],defaultLifespan=20,lastCoord=[],userInteracted=!1,delayShowRandom=3e3,animations=[[[[-3,-3]],[[-2,-2]],[[-1,-1]],[[0,0]],[[1,1]],[[2,2]],[[3,3]]],[[[4,-4]],[[3,-3]],[[2,-2]],[[1,-1]],[[0,0]],[[-1,1]],[[-2,2]]],[[[0,-2],[0,2],[2,0],[-2,0]],[[0,-3],[0,3],[3,0],[-3,0]],[[0,-4],[0,4],[4,0],[-4,0]],[[0,-5],[0,5],[5,0],[-5,0]]],[[[0,-2],[0,2],[2,0],[-2,0]],[[0,-3],[-3,0]],[[0,-4],[-4,0]],[[0,-5],[-4,0]],[[0,-6],[-5,0]]],[[[0,-2],[0,2],[2,0],[-2,0]],[[0,-3],[3,0]],[[0,-4],[4,0]]],[[[0,-2],[0,2],[2,0],[-2,0]],[[0,3],[3,0]],[[0,4],[4,0]]],[[[0,-2],[0,2],[2,0],[-2,0]],[[0,3],[-3,0]],[[0,4],[-4,0]]],[[[-4,-4]],[[-3,-3]],[[-2,-2]],[[-1,-1]],[[0,0]],[[1,0]],[[2,0]],[[3,0]]],[[[4,-4]],[[3,-3]],[[2,-2]],[[1,-1]],[[0,0]],[[-1,0]],[[-2,0]],[[-3,0]]],[[[4,-4]],[[3,-3]],[[2,-2]],[[1,-1]],[[0,0]],[[-1,1]],[[-2,2]],[[-2,1],[-1,2]],[[-2,0],[0,2]],[[-2,-1],[1,2]]],[[[-4,-4]],[[-3,-3]],[[-2,-2]],[[-1,-1]],[[0,0]],[[1,1]],[[2,2]],[[2,1],[1,2]],[[2,0],[0,2]],[[2,-1],[-1,2]]],[[[-5,2],[2,-5]],[[-5,1],[-4,2],[1,-5],[2,-4]],[[-5,0],[-3,2],[0,-5],[2,-3]],[[-5,-1],[-2,2],[-1,-5],[2,-2]],[[-5,-2],[-1,2],[-2,-5],[2,-1]],[[-5,-3],[0,2],[-3,-5],[2,0]],[[-5,-4],[1,2],[-4,-5],[2,1]],[[-5,-5],[2,2],[-5,-5],[2,2]],[[-4,1],[1,-4]],[[-4,0],[-3,1],[0,-4],[1,-3]],[[-4,-1],[-2,1],[-1,-4],[1,-2]],[[-4,-2],[-1,1],[-2,-4],[1,-1]],[[-4,-3],[-3,-4]],[[-4,-4],[1,1],[-4,-4],[1,1]],[[-3,0],[0,-3]],[[-3,-1],[-1,-3],[0,-2]],[[-3,-2],[-2,-3]],[[-3,-3],[-3,-3]],[[-2,-1],[-1,-2]],[[-2,-2],[-2,-2],[-1,-1]],[[-2,0]]],[[[-3,0]],[[-2,0]],[[-1,0]],[[-0,0]],[[1,1]],[[2,2]],[[3,3]],[[4,4]]]],textLatestNews="DERNIERES",lastRandomNumber;window.onresize=resizeStart;var latest,news,startScriptTime;